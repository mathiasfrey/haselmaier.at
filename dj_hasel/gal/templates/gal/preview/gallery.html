{% load gal i18n thumbnail %}
{# template to display several categories of a gallery #}
{# optional argument: gallery, either slug or pk #}
{# use first picture as main, the others under #}

<style type="text/css">
    .pix {
        margin: .5em auto;
        background: #000;
        max-width: 100%; /* prevent oversized images on mobile to destroy layout */
        
        -webkit-box-shadow: 2px 2px 5px 1px rgba(51,51,51,0.5);
        -moz-box-shadow: 2px 2px 5px 1px rgba(51,51,51,0.5);
        box-shadow: 2px 2px 5px 1px rgba(51,51,51,0.5);   
    }
</style>
    

{% get_gallery gallery as gal %}
{% for category in gal.categories.all %}
<div class="gallery-category">
    
    

    
        
    <div class="row">
        

        <h3>{{ category.title }}</h3>

  

        {% for header_image in category.pictures.all|slice:":1" %}
            <p>
            <a class="btn btn-default" href="{% url 'preview-category' gallery=gallery category=category.slug %}" 
                   class="" title='{% trans "Diese Galerie öffnen" %}'
                   data-toggle="modal" data-target="#category-preview-modal-{{category.pk}}">
                    {{category.pictures.all|length}} Bild{{ category.pictures.all|length|pluralize:"er" }} in Galerie öffnen
            </a>              
            </p>           
            
            {% thumbnail header_image.image "x320" crop="center" as im %}    
              <img src="{{ im.url }}" title="{{ header_image.title }}" alt="{{ header_image.title }}" class="pix">
            {% endthumbnail %}
        {% empty %}
           <!-- this category has no pictures? -->
           Keine Bilder in dieser Kategorie gefunden.
        {% endfor %}            
        
        
        {# more images under it #}
        {% comment %}
        slice - only a few images
        {% for pic in category.pictures.all|slice:"1:3" %}
        {% endcomment%}
        {% for pic in category.pictures.all|slice:"1:" %}
            
            {% thumbnail pic.image "x160" crop="center" as im %}    
              <img src="{{ im.url }}" title="{{ pic.title }}" alt="{{ pic.title }}"  class="pix" style="display: inline-block" />
            {% endthumbnail %}
            
        {% empty %}
        
        {% endfor %}
    


    </div>
    

    
    <hr />
    
    
</div>
{% include "gal/modal_external.html" with modal_id="category-preview-modal-" modal_id_addon=category.pk modal_label="Preview" %} 
{% endfor %}
